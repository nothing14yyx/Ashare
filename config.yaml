
app:
  # 输出目录（AshareApp.output_dir）
  output_dir: output
  # 是否拉取/增量更新日线K线数据（history_daily_kline）
  # true：会调用 Baostock K 线接口进行冷启动/增量更新
  # false：不请求 Baostock K 线接口，只从数据库表切片读取
  #       （要求 history_daily_kline 表已存在且非空）
  fetch_daily_kline: false

  # 是否导出股票元数据（股票列表/证券基本资料/行业分类/指数成分股）
  # true：会调用 Baostock 元数据接口更新 a_share_stock_list/a_share_stock_basic/a_share_stock_industry/index_*_members
  # false：不请求 Baostock 元数据接口，只从数据库读取（要求相关表已存在，或至少存在 history_daily_kline 用于兜底）
  fetch_stock_meta: false

  # 最近 N 个交易日窗口
  history_days: 365

  # 近期自然日视图窗口（仅用于你手动查询近期数据方便）
  # - 会创建/刷新视图：history_recent_{history_view_days}_days
  # - 与 history_days 解耦；history_days 仍用于程序内部计算窗口
  # - 设为 0 则不创建视图
  history_view_days: 45
  # 流动性排序时保留的股票数量
  top_liquidity_count: 100
  # 最少上市天数过滤阈值
  min_listing_days: 60
  # 是否在每次运行时刷新 Baostock 季频财务数据（非常耗时）
  # true：每次运行都会打 Baostock 接口，更新 fundamentals_quarter_* 表
  # false：只使用数据库中已有的财务表，直接拼接 fundamentals_latest_wide
  refresh_fundamentals: false

database:
  host: 127.0.0.1
  port: 3306
  user: root
  password: ""
  db_name: ashare
  # SQLAlchemy 连接池配置，避免频繁创建连接
  pool_size: 5
  max_overflow: 10
  pool_recycle: 1800
  pool_timeout: 30

proxy:
  http: http://127.0.0.1:7890
  https: http://127.0.0.1:7890

baostock:
  # Baostock 登录失败时的重试次数与间隔（秒）
  retry: 3
  retry_sleep: 3.0
  # Socket 超时（秒），防止底层网络调用无限等待
  socket_timeout: 30
  # 登录状态保活探测间隔（秒），避免高频心跳导致频繁登录
  keepalive_interval: 60
  # 单只股票拉取的子进程超时时间（秒）
  per_code_timeout: 30
  # 单只股票最大尝试次数
  max_retries: 2
  # 断点续跑判定：每只股票满足最少行数后视为已完成
  resume_min_rows_per_code: 200
  # 并发控制：默认/最小/最大子进程数以及网络带宽上限
  worker_processes: 1
  min_worker_processes: 1
  max_worker_processes: 8
  network_worker_cap: 1
  # 进度日志与批量写入配置
  progress_log_every: 100
  history_flush_batch: 5
  history_write_chunksize: 500
  # 清理策略：window=仅清理当前批次区间，skip=直接追加；history_retention_days>0 时会按窗口定期清理
  history_cleanup_mode: window
  history_retention_days: 0

akshare:
  enabled: true
  lhb:
    enabled: true
  margin:
    enabled: true
    exchanges:
      - sse
      - szse
  hsgt:
    enabled: true
    markets:
      - "沪股通"
      - "深股通"
    indicator: "5日排行"
  gdhs:
    enabled: true
    period: ""
    detail_enabled: true
    detail_top_n: 100

# MA5-MA20 顺势趋势波段系统
# - enabled: true  时会在 start.py 数据采集后自动运行，并写入两张策略表：
#   1) strategy_ma5_ma20_signals（信号快照）
#   2) strategy_ma5_ma20_candidates（BUY 候选清单）
strategy_ma5_ma20_trend:
  enabled: true
  # 选股池来源：top_liquidity（推荐，低频）/ universe / all
  universe_source: top_liquidity
  # 与 app.history_days 对齐（默认 365）
  lookback_days: 365

  volume_ratio_threshold: 1.5
  volume_ma_window: 5

  pullback_band: 0.01
  kdj_low_threshold: 30

  signals_table: strategy_ma5_ma20_signals
  candidates_table: strategy_ma5_ma20_candidates

